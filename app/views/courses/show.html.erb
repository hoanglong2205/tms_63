<% provide :title, @course.name %>
<div class="col-md-2 user_subject">
  <h3><%= t "admin.all_trainee" %></h3>
  <% @users.trainee.each do |user| %>
    <li><%= link_to user.name, user_path(user) %></li>
  <% end %>
</div>
<div class="subject col-md-10">
<h1><%= @course.name %></h1>
<div class="center"><%= @course.description %></div>
  <ul>
    <% @user_course.user_subjects.each do |user_subject| %>
      <% unless user_subject.status? %>
          <div class="col-md-6">
            <h3><li><%= user_subject.subject.name %></li></h3>
            <div>
              <%= form_for :user_subject, html: {class: "btn"},
                url:course_user_subject_path(@course, user_subject),
                method: :patch do |f| %>
                <%= f.hidden_field :status, value: true %>
                <%= f.submit t("admin.users.end_subject"),
                  class: "btn btn-primary hl-button" %>
              <% end %>
            </div>
            <div class="progress">
              <div class="progress-bar progress-bar-success" role="progressbar"
                aria-valuenow="70" aria-valuemin="0" aria-valuemax="100"
                style="width:<%= user_subject.progress %>%">
                <span><%= user_subject.progress %> %</span>
              </div>
            </div>
            <% user_subject.subject.tasks.each do |task| %>
              <div>
                <span><%= task.name %></span>
                <% if task.my_task(current_user.id, user_subject.id).present? %>
                  <div class="btn btn-danger hl-button2">
                    <%= t "admin.finished" %>
                  </div>
                <% else %>
                  <%= form_for :user_task, html: {class: "btn"},
                    url: course_user_tasks_path(@course) do |f| %>
                    <%= f.hidden_field :task_id, value: task.id %>
                    <%= f.hidden_field :user_id, value: current_user.id %>
                    <%= f.hidden_field :user_subject_id,
                      value: user_subject.id %>
                    <%= f.submit t("admin.finish"),
                      class: "btn btn-primary hl-button" %>
                  <% end %>
                <% end %>
              </div>
            <% end %>
          </div>
      <% else %>
        <div class="col-md-6">
          <h3><li><%= user_subject.subject.name %></li></h3>
          <div class="btn btn-danger hl-button2">
            <%= t "subjects.ended" %>
          </div>
          <div class="progress">
            <div class="progress-bar progress-bar-success" role="progressbar"
              aria-valuenow="70" aria-valuemin="0" aria-valuemax="100"
              style="width:<%= user_subject.progress %>%">
              <span><%= user_subject.progress %> %</span>
            </div>
          </div>
          <% user_subject.subject.tasks.each do |task| %>
            <div>
              <span><%= task.name %></span>
              <div class="btn btn-danger hl-button2">
                <%= t "admin.finished" %>
              </div>
            </div>
          <% end %>
        </div>
      <% end %>
    <% end %>
  </ul>
</div>
